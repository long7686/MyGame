{"version":3,"sources":["../../../../assets/Scripts/assets/Scripts/MainGameController.js"],"names":["Emitter","require","cc","Class","extends","Component","properties","_managerPhysics","_managerCollsion","effectHit","Prefab","onLoad","collision_manager","director","getCollisionManager","physics_manager","getPhysicsManager","enabled","enable","enabledDebugDraw","gravity","v2","instance","registerEvent","Shoot","bind","bulletPos","bullerDirec","bulletPre","bulletLookAt","node","getComponent","AudioSource","play","bullet","instantiate","effect","setPosition","angle","parent","addChild","action","moveBy","x","y","destroyBullet","callFunc","destroy","sequence","tween","to","scaleX","call","start","runAction"],"mappings":";;;;;;AAAA,IAAMA,UAAUC,QAAQ,gBAAR,CAAhB;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACTC,yBAAiB,IADR;AAETC,0BAAkB,IAFT;AAGTC,mBAAWP,GAAGQ;AAHL,KAHP;;AASLC,UATK,oBASK;AACN,YAAIC,oBAAoBV,GAAGW,QAAH,CAAYC,mBAAZ,EAAxB;AACA,YAAIC,kBAAkBb,GAAGW,QAAH,CAAYG,iBAAZ,EAAtB;AACAD,wBAAgBE,OAAhB,GAA0B,IAA1B;AACAL,0BAAkBM,MAAlB,GAA2B,IAA3B;AACAN,0BAAkBO,gBAAlB,GAAqC,IAArC;AACAJ,wBAAgBI,gBAAhB,GAAmC,IAAnC;AACAJ,wBAAgBK,OAAhB,GAA0B,IAAIlB,GAAGmB,EAAP,CAAU,CAAV,EAAY,CAAZ,CAA1B;;AAEArB,gBAAQsB,QAAR,GAAmB,IAAItB,OAAJ,EAAnB;AACAA,gBAAQsB,QAAR,CAAiBC,aAAjB,CAA+B,aAA/B,EAA8C,KAAKC,KAAL,CAAWC,IAAX,CAAgB,IAAhB,CAA9C;AACH,KApBI;AAsBLD,SAtBK,iBAsBCE,SAtBD,EAsBYC,WAtBZ,EAsByBC,SAtBzB,EAsBoCC,YAtBpC,EAsBiD;AAClD,aAAKC,IAAL,CAAUC,YAAV,CAAuB7B,GAAG8B,WAA1B,EAAuCC,IAAvC;AACA,YAAIC,SAAShC,GAAGiC,WAAH,CAAeP,SAAf,CAAb;AACA,YAAIQ,SAASlC,GAAGiC,WAAH,CAAe,KAAK1B,SAApB,CAAb;;AAEAyB,eAAOG,WAAP,CAAmBX,SAAnB;AACAQ,eAAOI,KAAP,GAAeT,YAAf;AACAO,eAAOE,KAAP,GAAeT,YAAf;AACAO,eAAOC,WAAP,CAAmBX,SAAnB;;AAEA,aAAKI,IAAL,CAAUS,MAAV,CAAiBC,QAAjB,CAA0BJ,MAA1B;AACA,aAAKN,IAAL,CAAUS,MAAV,CAAiBC,QAAjB,CAA0BN,MAA1B;;AAEA,YAAIO,SAASvC,GAAGwC,MAAH,CAAU,CAAV,EAAaxC,GAAGmB,EAAH,CAAMM,YAAYgB,CAAZ,GAAgB,EAAtB,EAA0BhB,YAAYiB,CAAZ,GAAgB,EAA1C,CAAb,CAAb;AACA,YAAIC,gBAAgB3C,GAAG4C,QAAH,CAAY,YAAU;AACtCZ,mBAAOa,OAAP;AACH,SAFmB,EAElB,IAFkB,CAApB;AAGA,YAAIC,WAAW9C,GAAG8C,QAAH,CAAYP,MAAZ,EAAoBI,aAApB,CAAf;AACA3C,WAAG+C,KAAH,CAASb,MAAT,EACKc,EADL,CACQ,GADR,EACY,EAACC,QAAO,CAAR,EADZ,EAEKC,IAFL,CAEU;AAAA,mBAAMhB,OAAOW,OAAP,EAAN;AAAA,SAFV,EAGKM,KAHL;AAIAnB,eAAOoB,SAAP,CAAiBN,QAAjB;AACH;AA7CI,CAAT","file":"MainGameController.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["const Emitter = require(\"EventsListener\")\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n       _managerPhysics: null,\n       _managerCollsion: null,\n       effectHit: cc.Prefab,\n    },\n    \n    onLoad () {\n        let collision_manager = cc.director.getCollisionManager();\n        let physics_manager = cc.director.getPhysicsManager()\n        physics_manager.enabled = true;\n        collision_manager.enable = true;\n        collision_manager.enabledDebugDraw = true\n        physics_manager.enabledDebugDraw = true\n        physics_manager.gravity = new cc.v2(0,0)\n\n        Emitter.instance = new Emitter()\n        Emitter.instance.registerEvent(\"SpawnBullet\", this.Shoot.bind(this))\n    },\n\n    Shoot(bulletPos, bullerDirec, bulletPre, bulletLookAt){\n        this.node.getComponent(cc.AudioSource).play();\n        let bullet = cc.instantiate(bulletPre)  \n        let effect = cc.instantiate(this.effectHit) \n\n        bullet.setPosition(bulletPos)\n        bullet.angle = bulletLookAt\n        effect.angle = bulletLookAt\n        effect.setPosition(bulletPos)\n\n        this.node.parent.addChild(effect)\n        this.node.parent.addChild(bullet)   \n\n        let action = cc.moveBy(3, cc.v2(bullerDirec.x * 10, bullerDirec.y * 10))\n        let destroyBullet = cc.callFunc(function(){\n            bullet.destroy();\n        },this)\n        let sequence = cc.sequence(action, destroyBullet)\n        cc.tween(effect)\n            .to(0.1,{scaleX:0})\n            .call(() => effect.destroy())\n            .start()  \n        bullet.runAction(sequence)    \n    },\n});\n"]}